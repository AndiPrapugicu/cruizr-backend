const sqlite3 = require('sqlite3').verbose();
const db = new sqlite3.Database('./database.sqlite');

// Store items to populate
const storeItems = [
  {
    id: 1,
    itemId: 'profile-boost-1h',
    name: 'Profile Boost (1h)',
    description: 'Boost your profile visibility for 1 hour',
    icon: 'üöÄ',
    price: 50,
    currency: 'fuel',
    category: 'visibility',
    subcategory: null,
    duration: 1,
    maxUses: null,
    isActive: true,
    isPermanent: false,
    isLimited: false,
    limitedQuantity: null,
    requirements: null,
    effects: { type: 'visibility', multiplier: 2 },
    metadata: { rarity: 'common' },
  },
  {
    id: 2,
    itemId: 'profile-boost-6h',
    name: 'Profile Boost (6h)',
    description: 'Boost your profile visibility for 6 hours',
    icon: 'üöÄ',
    price: 250,
    currency: 'fuel',
    category: 'visibility',
    subcategory: null,
    duration: 6,
    maxUses: null,
    isActive: true,
    isPermanent: false,
    isLimited: false,
    limitedQuantity: null,
    requirements: null,
    effects: { type: 'visibility', multiplier: 2 },
    metadata: { rarity: 'uncommon' },
  },
  {
    id: 3,
    itemId: 'super-boost-1h',
    name: 'Super Boost (1h)',
    description: 'Super boost your profile visibility for 1 hour',
    icon: '‚ö°',
    price: 100,
    currency: 'fuel',
    category: 'visibility',
    subcategory: null,
    duration: 1,
    maxUses: null,
    isActive: true,
    isPermanent: false,
    isLimited: false,
    limitedQuantity: null,
    requirements: null,
    effects: { type: 'visibility', multiplier: 5 },
    metadata: { rarity: 'rare' },
  },
  {
    id: 4,
    itemId: 'reverse-swipe',
    name: 'Reverse Swipe',
    description: 'Undo your last swipe',
    icon: '‚Ü©Ô∏è',
    price: 20,
    currency: 'fuel',
    category: 'matching-tools',
    subcategory: null,
    duration: null,
    maxUses: 1,
    isActive: true,
    isPermanent: false,
    isLimited: false,
    limitedQuantity: null,
    requirements: null,
    effects: { type: 'matching' },
    metadata: { rarity: 'common' },
  },
  {
    id: 5,
    itemId: 'see-who-liked',
    name: 'See Who Liked Me',
    description: 'Reveal who liked your profile',
    icon: 'üëÅÔ∏è',
    price: 75,
    currency: 'fuel',
    category: 'discovery',
    subcategory: null,
    duration: null,
    maxUses: null,
    isActive: true,
    isPermanent: false,
    isLimited: false,
    limitedQuantity: null,
    requirements: null,
    effects: { type: 'discovery' },
    metadata: { rarity: 'uncommon' },
  },
  {
    id: 6,
    itemId: 'super-like-5pack',
    name: 'Super Likes (5 pack)',
    description: 'Get 5 super likes to stand out',
    icon: '‚≠ê',
    price: 30,
    currency: 'fuel',
    category: 'matching-tools',
    subcategory: null,
    duration: null,
    maxUses: 5,
    isActive: true,
    isPermanent: false,
    isLimited: false,
    limitedQuantity: null,
    requirements: null,
    effects: { type: 'matching' },
    metadata: { rarity: 'common' },
  },
  {
    id: 7,
    itemId: 'premium-membership-1month',
    name: 'Premium Membership (1 Month)',
    description: 'Get premium features for 1 month',
    icon: 'üíé',
    price: 10,
    currency: 'premium',
    category: 'membership',
    subcategory: null,
    duration: 720, // 30 days * 24 hours
    maxUses: null,
    isActive: true,
    isPermanent: false,
    isLimited: false,
    limitedQuantity: null,
    requirements: null,
    effects: { type: 'membership' },
    metadata: { rarity: 'epic' },
  },
  {
    id: 8,
    itemId: 'vip-status-7days',
    name: 'VIP Status (7 days)',
    description: 'Get VIP status for 7 days',
    icon: 'üëë',
    price: 5,
    currency: 'premium',
    category: 'membership',
    subcategory: null,
    duration: 168, // 7 days * 24 hours
    maxUses: null,
    isActive: true,
    isPermanent: false,
    isLimited: false,
    limitedQuantity: null,
    requirements: null,
    effects: { type: 'membership' },
    metadata: { rarity: 'rare' },
  },
  {
    id: 9,
    itemId: 'animated-profile-frame',
    name: 'Animated Profile Frame',
    description: 'Add a special animated frame to your profile',
    icon: 'üé®',
    price: 3,
    currency: 'premium',
    category: 'profile-customization',
    subcategory: null,
    duration: null,
    maxUses: null,
    isActive: true,
    isPermanent: true,
    isLimited: false,
    limitedQuantity: null,
    requirements: null,
    effects: { type: 'profile' },
    metadata: { rarity: 'rare', animation: 'glow' },
  },
  {
    id: 10,
    itemId: 'custom-bio-effects',
    name: 'Custom Bio Effects',
    description: 'Add special effects to your bio',
    icon: '‚ú®',
    price: 2,
    currency: 'premium',
    category: 'profile-customization',
    subcategory: null,
    duration: null,
    maxUses: null,
    isActive: true,
    isPermanent: true,
    isLimited: false,
    limitedQuantity: null,
    requirements: null,
    effects: { type: 'profile' },
    metadata: { rarity: 'common', effect: 'sparkle' },
  },
  {
    id: 11,
    itemId: 'unlimited-swipes-24h',
    name: 'Unlimited Swipes (24h)',
    description: 'Get unlimited swipes for 24 hours',
    icon: '‚àû',
    price: 4,
    currency: 'premium',
    category: 'matching-tools',
    subcategory: null,
    duration: 24,
    maxUses: null,
    isActive: true,
    isPermanent: false,
    isLimited: false,
    limitedQuantity: null,
    requirements: null,
    effects: { type: 'matching' },
    metadata: { rarity: 'uncommon' },
  },
  {
    id: 12,
    itemId: 'passport-travel',
    name: 'Passport Travel',
    description: 'Change your location to anywhere in the world',
    icon: 'üåç',
    price: 8,
    currency: 'premium',
    category: 'location',
    subcategory: null,
    duration: null,
    maxUses: null,
    isActive: true,
    isPermanent: false,
    isLimited: false,
    limitedQuantity: null,
    requirements: null,
    effects: { type: 'location' },
    metadata: { rarity: 'rare' },
  },
  {
    id: 13,
    itemId: 'read-receipts',
    name: 'Read Receipts',
    description: 'See when your messages are read',
    icon: '‚úì',
    price: 3,
    currency: 'premium',
    category: 'communication',
    subcategory: null,
    duration: null,
    maxUses: null,
    isActive: true,
    isPermanent: false,
    isLimited: false,
    limitedQuantity: null,
    requirements: null,
    effects: { type: 'communication' },
    metadata: { rarity: 'common' },
  },
  {
    id: 14,
    itemId: 'monthly-boost-pack',
    name: 'Monthly Boost Pack',
    description: 'Get 30 profile boosts for the month',
    icon: 'üì¶',
    price: 15,
    currency: 'premium',
    category: 'visibility',
    subcategory: null,
    duration: 720, // 30 days * 24 hours
    maxUses: 30,
    isActive: true,
    isPermanent: false,
    isLimited: false,
    limitedQuantity: null,
    requirements: null,
    effects: { type: 'visibility' },
    metadata: { rarity: 'epic' },
  },
  {
    id: 15,
    itemId: 'spotlight',
    name: 'Spotlight',
    description: 'Be the top profile for 30 minutes',
    icon: 'üî¶',
    price: 25,
    currency: 'fuel',
    category: 'visibility',
    subcategory: null,
    duration: 0.5, // 30 minutes
    maxUses: null,
    isActive: true,
    isPermanent: false,
    isLimited: false,
    limitedQuantity: null,
    requirements: null,
    effects: { type: 'visibility', multiplier: 10 },
    metadata: { rarity: 'epic' },
  },
  {
    id: 16,
    itemId: 'double-swipe-chance',
    name: 'Double Swipe Chance',
    description: 'Double your chances of getting matched',
    icon: 'üéØ',
    price: 15,
    currency: 'premium',
    category: 'matching-tools',
    subcategory: null,
    duration: 24,
    maxUses: null,
    isActive: true,
    isPermanent: false,
    isLimited: false,
    limitedQuantity: null,
    requirements: null,
    effects: { type: 'matching', multiplier: 2 },
    metadata: { rarity: 'rare' },
  },
  {
    id: 17,
    itemId: 'premium-access',
    name: 'Premium Access',
    description: 'Get access to all premium features',
    icon: 'üîì',
    price: 50,
    currency: 'premium',
    category: 'membership',
    subcategory: null,
    duration: 168, // 7 days * 24 hours
    maxUses: null,
    isActive: true,
    isPermanent: false,
    isLimited: false,
    limitedQuantity: null,
    requirements: null,
    effects: { type: 'membership' },
    metadata: { rarity: 'legendary' },
  },
  {
    id: 18,
    itemId: 'profile-theme',
    name: 'Profile Theme',
    description: 'Customize your profile with themes',
    icon: 'üé®',
    price: 30,
    currency: 'premium',
    category: 'profile-customization',
    subcategory: null,
    duration: null,
    maxUses: null,
    isActive: true,
    isPermanent: true,
    isLimited: false,
    limitedQuantity: null,
    requirements: null,
    effects: { type: 'profile' },
    metadata: { rarity: 'rare' },
  },
  {
    id: 19,
    itemId: 'spotlight-premium',
    name: 'Spotlight',
    description: 'Be the top profile for 30 minutes (Premium)',
    icon: 'üî¶',
    price: 25,
    currency: 'premium',
    category: 'visibility',
    subcategory: null,
    duration: 0.5, // 30 minutes
    maxUses: null,
    isActive: true,
    isPermanent: false,
    isLimited: false,
    limitedQuantity: null,
    requirements: null,
    effects: { type: 'visibility', multiplier: 10 },
    metadata: { rarity: 'epic' },
  },
  {
    id: 20,
    itemId: 'highlight-profile',
    name: 'Highlight Profile',
    description: 'Highlight your profile with special effects',
    icon: 'üåü',
    price: 20,
    currency: 'premium',
    category: 'visibility',
    subcategory: null,
    duration: 24,
    maxUses: null,
    isActive: true,
    isPermanent: false,
    isLimited: false,
    limitedQuantity: null,
    requirements: null,
    effects: { type: 'visibility', multiplier: 3 },
    metadata: { rarity: 'rare' },
  },
  {
    id: 21,
    itemId: 'fuel-streak-bonus',
    name: 'Fuel Streak Bonus',
    description: 'Get bonus fuel for maintaining streaks',
    icon: 'üî•',
    price: 30,
    currency: 'premium',
    category: 'fuel-system',
    subcategory: null,
    duration: 168, // 7 days * 24 hours
    maxUses: null,
    isActive: true,
    isPermanent: false,
    isLimited: false,
    limitedQuantity: null,
    requirements: null,
    effects: { type: 'fuel', multiplier: 1.5 },
    metadata: { rarity: 'uncommon' },
  },
];

console.log('Populating store items...');

// Insert all items
const insertPromises = storeItems.map((item) => {
  return new Promise((resolve, reject) => {
    const sql = `
      INSERT INTO store_items (
        id, itemId, name, description, icon, price, currency, category, 
        subcategory, duration, maxUses, isActive, isPermanent, isLimited, 
        limitedQuantity, requirements, effects, metadata, createdAt, updatedAt
      ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
    `;

    const now = new Date().toISOString();

    db.run(
      sql,
      [
        item.id,
        item.itemId,
        item.name,
        item.description,
        item.icon,
        item.price,
        item.currency,
        item.category,
        item.subcategory,
        item.duration,
        item.maxUses,
        item.isActive,
        item.isPermanent,
        item.isLimited,
        item.limitedQuantity,
        JSON.stringify(item.requirements),
        JSON.stringify(item.effects),
        JSON.stringify(item.metadata),
        now,
        now,
      ],
      function (err) {
        if (err) {
          reject(err);
        } else {
          console.log(`‚úÖ Added: ${item.name} (${item.itemId})`);
          resolve(this.lastID);
        }
      },
    );
  });
});

Promise.all(insertPromises)
  .then(() => {
    console.log('üéâ All store items have been populated successfully!');
    db.close();
  })
  .catch((err) => {
    console.error('‚ùå Error populating store items:', err);
    db.close();
  });
