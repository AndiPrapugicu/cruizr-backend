const sqlite3 = require('sqlite3').verbose();
const db = new sqlite3.Database('./database.sqlite');

// Clear existing items
console.log('Clearing existing store items...');

db.run('DELETE FROM store_items', (err) => {
  if (err) {
    console.error('Error clearing store items:', err);
    return;
  }

  console.log('✅ Existing store items cleared');

  // Now populate with new structured items
  populateStructuredItems();
});

function populateStructuredItems() {
  const structuredItems = [
    // 🔧 FUEL POINTS SHOP - Categorii și beneficii

    // 1. Boostere de Vizibilitate
    {
      id: 1,
      itemId: 'spotlight-30min',
      name: 'Spotlight (30 min)',
      description: 'Apari primul în swipe-uri locale timp de 30 minute',
      icon: '🔦',
      price: 25,
      currency: 'fuel',
      category: 'visibility-boost',
      subcategory: 'spotlight',
      duration: 0.5, // 30 minutes
      maxUses: null,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'visibility', multiplier: 10, priority: 'first' },
      metadata: {
        rarity: 'epic',
        shopSection: 'fuel',
        categoryDisplayName: 'Boostere de Vizibilitate',
        benefits: ['Apari primul în swipe-uri', 'Vizibilitate maximă locală'],
      },
    },
    {
      id: 2,
      itemId: 'double-swipe-chance',
      name: 'Double Swipe Chance',
      description: 'Apari de două ori unei persoane pentru șanse mai mari',
      icon: '🎯',
      price: 15,
      currency: 'fuel',
      category: 'visibility-boost',
      subcategory: 'double-chance',
      duration: 24,
      maxUses: null,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'matching', multiplier: 2, doubleChance: true },
      metadata: {
        rarity: 'rare',
        shopSection: 'fuel',
        categoryDisplayName: 'Boostere de Vizibilitate',
        benefits: ['Apari de două ori', 'Șanse dublate de match'],
      },
    },
    {
      id: 3,
      itemId: 'highlight-profile-24h',
      name: 'Highlight Profile (24h)',
      description: 'Profilul tău are un contur colorat special timp de 24 ore',
      icon: '🌟',
      price: 20,
      currency: 'fuel',
      category: 'visibility-boost',
      subcategory: 'highlight',
      duration: 24,
      maxUses: null,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'visibility', multiplier: 3, highlight: true },
      metadata: {
        rarity: 'rare',
        shopSection: 'fuel',
        categoryDisplayName: 'Boostere de Vizibilitate',
        benefits: ['Contur colorat special', 'Vizibilitate crescută'],
      },
    },
    {
      id: 4,
      itemId: 'fuel-streak-bonus',
      name: 'Fuel Streak Bonus',
      description: 'Bonus extra dacă ești activ zilnic - mai multe fuel points',
      icon: '🔥',
      price: 30,
      currency: 'fuel',
      category: 'visibility-boost',
      subcategory: 'streak',
      duration: 168, // 7 days
      maxUses: null,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'fuel', multiplier: 1.5, streakBonus: true },
      metadata: {
        rarity: 'uncommon',
        shopSection: 'fuel',
        categoryDisplayName: 'Boostere de Vizibilitate',
        benefits: ['Bonus fuel zilnic', 'Recompense pentru activitate'],
      },
    },

    // 2. Personalizare profil
    {
      id: 5,
      itemId: 'special-frame',
      name: 'Rama Specială',
      description: 'Rama unică pentru profilul tău - se păstrează permanent',
      icon: '🖼️',
      price: 50,
      currency: 'fuel',
      category: 'profile-customization',
      subcategory: 'frame',
      duration: null,
      maxUses: null,
      isActive: true,
      isPermanent: true,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'profile', customization: 'frame' },
      metadata: {
        rarity: 'rare',
        shopSection: 'fuel',
        categoryDisplayName: 'Personalizare Profil',
        benefits: ['Rama unică', 'Personalizare permanentă'],
      },
    },
    {
      id: 6,
      itemId: 'animated-car-background',
      name: 'Background Animat Mașină',
      description: 'Background animat pentru mașina din profil',
      icon: '🎨',
      price: 40,
      currency: 'fuel',
      category: 'profile-customization',
      subcategory: 'background',
      duration: null,
      maxUses: null,
      isActive: true,
      isPermanent: true,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: {
        type: 'profile',
        customization: 'background',
        animation: true,
      },
      metadata: {
        rarity: 'epic',
        shopSection: 'fuel',
        categoryDisplayName: 'Personalizare Profil',
        benefits: ['Background animat', 'Efect vizual impresionant'],
      },
    },
    {
      id: 7,
      itemId: 'daily-driver-badge',
      name: 'Badge "Daily Driver"',
      description:
        'Badge special vizibil în profil - arată că ești pasionat zilnic',
      icon: '🏁',
      price: 35,
      currency: 'fuel',
      category: 'profile-customization',
      subcategory: 'badge',
      duration: null,
      maxUses: null,
      isActive: true,
      isPermanent: true,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'profile', badge: 'daily-driver' },
      metadata: {
        rarity: 'uncommon',
        shopSection: 'fuel',
        categoryDisplayName: 'Personalizare Profil',
        benefits: ['Badge special', 'Arată dedicarea ta'],
      },
    },
    {
      id: 8,
      itemId: 'weekend-warrior-badge',
      name: 'Badge "Weekend Warrior"',
      description: 'Badge special pentru pasionații de weekend',
      icon: '🏆',
      price: 35,
      currency: 'fuel',
      category: 'profile-customization',
      subcategory: 'badge',
      duration: null,
      maxUses: null,
      isActive: true,
      isPermanent: true,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'profile', badge: 'weekend-warrior' },
      metadata: {
        rarity: 'uncommon',
        shopSection: 'fuel',
        categoryDisplayName: 'Personalizare Profil',
        benefits: ['Badge weekend', 'Stil de viață relaxat'],
      },
    },
    {
      id: 9,
      itemId: 'custom-color-theme',
      name: 'Tema de Culori Personalizată',
      description: 'Customizează culorile interfeței aplicației',
      icon: '🎨',
      price: 45,
      currency: 'fuel',
      category: 'profile-customization',
      subcategory: 'theme',
      duration: null,
      maxUses: null,
      isActive: true,
      isPermanent: true,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'interface', customization: 'theme' },
      metadata: {
        rarity: 'rare',
        shopSection: 'fuel',
        categoryDisplayName: 'Personalizare Profil',
        benefits: ['Culori personalizate', 'Interfață unică'],
      },
    },

    // 3. Interacțiuni sociale
    {
      id: 10,
      itemId: 'car-of-week-vote',
      name: 'Vot "Car of the Week"',
      description: 'Participă la votarea mașinii săptămânii',
      icon: '🗳️',
      price: 10,
      currency: 'fuel',
      category: 'social-interaction',
      subcategory: 'voting',
      duration: 168, // 7 days
      maxUses: null,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'social', feature: 'voting' },
      metadata: {
        rarity: 'common',
        shopSection: 'fuel',
        categoryDisplayName: 'Interacțiuni Sociale',
        benefits: ['Participă la voting', 'Comunitate activă'],
      },
    },
    {
      id: 11,
      itemId: 'priority-chat-replies',
      name: 'Prioritizează Răspunsurile în Chat',
      description: 'Mesajele tale apar mai repede în chat',
      icon: '⚡',
      price: 25,
      currency: 'fuel',
      category: 'social-interaction',
      subcategory: 'chat',
      duration: 72, // 3 days
      maxUses: null,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'communication', priority: true },
      metadata: {
        rarity: 'rare',
        shopSection: 'fuel',
        categoryDisplayName: 'Interacțiuni Sociale',
        benefits: ['Mesaje prioritare', 'Răspunsuri mai rapide'],
      },
    },
    {
      id: 12,
      itemId: 'community-meme-vote',
      name: 'Votează Meme-uri în Comunitate',
      description: 'Participă la votarea celor mai bune meme-uri auto',
      icon: '😂',
      price: 15,
      currency: 'fuel',
      category: 'social-interaction',
      subcategory: 'memes',
      duration: 168, // 7 days
      maxUses: null,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'social', feature: 'meme-voting' },
      metadata: {
        rarity: 'common',
        shopSection: 'fuel',
        categoryDisplayName: 'Interacțiuni Sociale',
        benefits: ['Votează meme-uri', 'Divertisment comunitar'],
      },
    },
    {
      id: 13,
      itemId: 'exclusive-polls-access',
      name: 'Acces la Sondaje Exclusive',
      description:
        'Participă la sondaje speciale despre mașini și trending topics',
      icon: '📊',
      price: 20,
      currency: 'fuel',
      category: 'social-interaction',
      subcategory: 'polls',
      duration: 168, // 7 days
      maxUses: null,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'social', feature: 'exclusive-polls' },
      metadata: {
        rarity: 'uncommon',
        shopSection: 'fuel',
        categoryDisplayName: 'Interacțiuni Sociale',
        benefits: ['Sondaje exclusive', 'Opinii valoroase'],
      },
    },
    {
      id: 14,
      itemId: 'exclusive-chat-emojis',
      name: 'Emojis Exclusive în Chat',
      description: 'Folosește emoji-uri speciale doar pentru membrii activi',
      icon: '🚗',
      price: 30,
      currency: 'fuel',
      category: 'social-interaction',
      subcategory: 'emojis',
      duration: null,
      maxUses: null,
      isActive: true,
      isPermanent: true,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'communication', feature: 'exclusive-emojis' },
      metadata: {
        rarity: 'rare',
        shopSection: 'fuel',
        categoryDisplayName: 'Interacțiuni Sociale',
        benefits: ['Emoji-uri exclusive', 'Expresivitate sporită'],
      },
    },

    // 4. Acces rapid
    {
      id: 15,
      itemId: 'reverse-swipe',
      name: 'Unlock Swipe Rewind',
      description: 'Dai înapoi dacă ai dat swipe greșit - o utilizare',
      icon: '↩️',
      price: 20,
      currency: 'fuel',
      category: 'quick-access',
      subcategory: 'rewind',
      duration: null,
      maxUses: 1,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'matching', feature: 'rewind' },
      metadata: {
        rarity: 'common',
        shopSection: 'fuel',
        categoryDisplayName: 'Acces Rapid',
        benefits: ['Corectează swipe-uri', 'Șanse în plus'],
      },
    },
    {
      id: 16,
      itemId: 'daily-who-swiped',
      name: 'Vezi cine ți-a dat swipe (1 dată/zi)',
      description: 'Descoperă cine te-a swipe-uit - o utilizare pe zi',
      icon: '👁️',
      price: 25,
      currency: 'fuel',
      category: 'quick-access',
      subcategory: 'reveal',
      duration: 24,
      maxUses: 1,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'discovery', feature: 'daily-reveal' },
      metadata: {
        rarity: 'uncommon',
        shopSection: 'fuel',
        categoryDisplayName: 'Acces Rapid',
        benefits: ['Vezi cine te-a swipe-uit', 'Informații valoroase'],
      },
    },
    {
      id: 17,
      itemId: 'refresh-swipe-zone',
      name: 'Refresh Zona de Swipe',
      description: 'Reîncarcă locațiile și găsește persoane noi',
      icon: '🔄',
      price: 15,
      currency: 'fuel',
      category: 'quick-access',
      subcategory: 'refresh',
      duration: null,
      maxUses: 1,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'matching', feature: 'refresh' },
      metadata: {
        rarity: 'common',
        shopSection: 'fuel',
        categoryDisplayName: 'Acces Rapid',
        benefits: ['Persoane noi', 'Locații reîncărcate'],
      },
    },

    // 💎 PREMIUM POINTS SHOP - Beneficii exclusive

    // 1. Premium Match Experience
    {
      id: 18,
      itemId: 'unlimited-who-liked',
      name: 'Vezi toți cei care te-au dat swipe (nelimitat)',
      description: 'Acces nelimitat la cine te-a swipe-uit - fără restricții',
      icon: '👀',
      price: 50,
      currency: 'premium',
      category: 'premium-match',
      subcategory: 'unlimited-reveal',
      duration: null,
      maxUses: null,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'discovery', feature: 'unlimited-reveal' },
      metadata: {
        rarity: 'legendary',
        shopSection: 'premium',
        categoryDisplayName: 'Premium Match Experience',
        benefits: ['Acces nelimitat', 'Toate swipe-urile vizibile'],
      },
    },
    {
      id: 19,
      itemId: 'absolute-priority',
      name: 'Prioritizare Absolută în Swipe List',
      description: 'Apari primul în lista de swipe-uri la toată lumea',
      icon: '👑',
      price: 75,
      currency: 'premium',
      category: 'premium-match',
      subcategory: 'absolute-priority',
      duration: 168, // 7 days
      maxUses: null,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'visibility', priority: 'absolute', multiplier: 20 },
      metadata: {
        rarity: 'legendary',
        shopSection: 'premium',
        categoryDisplayName: 'Premium Match Experience',
        benefits: ['Prioritate absolută', 'Vizibilitate maximă'],
      },
    },
    {
      id: 20,
      itemId: 'chat-without-match',
      name: 'Chat fără Match',
      description: 'Poți trimite 1 mesaj special fără match - doar premium',
      icon: '💬',
      price: 30,
      currency: 'premium',
      category: 'premium-match',
      subcategory: 'no-match-chat',
      duration: null,
      maxUses: 1,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'communication', feature: 'no-match-message' },
      metadata: {
        rarity: 'epic',
        shopSection: 'premium',
        categoryDisplayName: 'Premium Match Experience',
        benefits: ['Mesaj fără match', 'Șanse în plus'],
      },
    },
    {
      id: 21,
      itemId: 'match-radar',
      name: 'Match Radar',
      description: 'Arătare potențiali compatibili în jurul tău - live updates',
      icon: '📡',
      price: 60,
      currency: 'premium',
      category: 'premium-match',
      subcategory: 'radar',
      duration: 168, // 7 days
      maxUses: null,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'discovery', feature: 'match-radar' },
      metadata: {
        rarity: 'legendary',
        shopSection: 'premium',
        categoryDisplayName: 'Premium Match Experience',
        benefits: ['Live radar', 'Compatibili în apropiere'],
      },
    },
    {
      id: 22,
      itemId: 'super-boosted-like',
      name: 'Like Super Boosted',
      description: 'Apari în topul feed-ului lor când dai like',
      icon: '⭐',
      price: 25,
      currency: 'premium',
      category: 'premium-match',
      subcategory: 'super-like',
      duration: null,
      maxUses: 5,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'matching', feature: 'super-boosted-like' },
      metadata: {
        rarity: 'epic',
        shopSection: 'premium',
        categoryDisplayName: 'Premium Match Experience',
        benefits: ['Like super boosted', 'Atenție maximă'],
      },
    },

    // 2. Customizare avansată
    {
      id: 23,
      itemId: 'profile-3d-view',
      name: 'Profil 3D View cu mașina ta',
      description: 'Vizualizare 3D interactivă a mașinii tale în profil',
      icon: '🎮',
      price: 80,
      currency: 'premium',
      category: 'advanced-customization',
      subcategory: '3d-view',
      duration: null,
      maxUses: null,
      isActive: true,
      isPermanent: true,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'profile', feature: '3d-view' },
      metadata: {
        rarity: 'legendary',
        shopSection: 'premium',
        categoryDisplayName: 'Customizare Avansată',
        benefits: ['Vizualizare 3D', 'Experiență interactivă'],
      },
    },
    {
      id: 24,
      itemId: 'iconic-car-theme-gtr',
      name: 'Tema Premium - GTR',
      description: 'Tema inspirată din mașini iconice - Nissan GTR',
      icon: '🏎️',
      price: 45,
      currency: 'premium',
      category: 'advanced-customization',
      subcategory: 'iconic-theme',
      duration: null,
      maxUses: null,
      isActive: true,
      isPermanent: true,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'interface', theme: 'gtr' },
      metadata: {
        rarity: 'epic',
        shopSection: 'premium',
        categoryDisplayName: 'Customizare Avansată',
        benefits: ['Tema GTR', 'Design iconic'],
      },
    },
    {
      id: 25,
      itemId: 'iconic-car-theme-m3',
      name: 'Tema Premium - BMW M3',
      description: 'Tema inspirată din mașini iconice - BMW M3',
      icon: '🚙',
      price: 45,
      currency: 'premium',
      category: 'advanced-customization',
      subcategory: 'iconic-theme',
      duration: null,
      maxUses: null,
      isActive: true,
      isPermanent: true,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'interface', theme: 'm3' },
      metadata: {
        rarity: 'epic',
        shopSection: 'premium',
        categoryDisplayName: 'Customizare Avansată',
        benefits: ['Tema M3', 'Eleganță sportivy'],
      },
    },
    {
      id: 26,
      itemId: 'iconic-car-theme-wrx',
      name: 'Tema Premium - Subaru WRX',
      description: 'Tema inspirată din mașini iconice - Subaru WRX',
      icon: '🚗',
      price: 45,
      currency: 'premium',
      category: 'advanced-customization',
      subcategory: 'iconic-theme',
      duration: null,
      maxUses: null,
      isActive: true,
      isPermanent: true,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'interface', theme: 'wrx' },
      metadata: {
        rarity: 'epic',
        shopSection: 'premium',
        categoryDisplayName: 'Customizare Avansată',
        benefits: ['Tema WRX', 'Spirit rally'],
      },
    },
    {
      id: 27,
      itemId: 'premium-racer-badge',
      name: 'Badge "Premium Racer" Animat',
      description: 'Badge premium animat exclusiv pentru membri premium',
      icon: '🏁',
      price: 35,
      currency: 'premium',
      category: 'advanced-customization',
      subcategory: 'premium-badge',
      duration: null,
      maxUses: null,
      isActive: true,
      isPermanent: true,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'profile', badge: 'premium-racer', animated: true },
      metadata: {
        rarity: 'legendary',
        shopSection: 'premium',
        categoryDisplayName: 'Customizare Avansată',
        benefits: ['Badge animat', 'Status premium'],
      },
    },
  ];

  console.log('Populating structured store items...');

  const insertPromises = structuredItems.map((item) => {
    return new Promise((resolve, reject) => {
      const sql = `
        INSERT INTO store_items (
          id, itemId, name, description, icon, price, currency, category, 
          subcategory, duration, maxUses, isActive, isPermanent, isLimited, 
          limitedQuantity, requirements, effects, metadata, createdAt, updatedAt
        ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
      `;

      const now = new Date().toISOString();

      db.run(
        sql,
        [
          item.id,
          item.itemId,
          item.name,
          item.description,
          item.icon,
          item.price,
          item.currency,
          item.category,
          item.subcategory,
          item.duration,
          item.maxUses,
          item.isActive,
          item.isPermanent,
          item.isLimited,
          item.limitedQuantity,
          JSON.stringify(item.requirements),
          JSON.stringify(item.effects),
          JSON.stringify(item.metadata),
          now,
          now,
        ],
        function (err) {
          if (err) {
            reject(err);
          } else {
            console.log(
              `✅ Added: ${item.name} (${item.currency.toUpperCase()}: ${item.price})`,
            );
            resolve(this.lastID);
          }
        },
      );
    });
  });

  Promise.all(insertPromises)
    .then(() => {
      console.log(
        '\n🎉 All structured store items have been populated successfully!',
      );
      console.log('\n📊 Summary:');
      console.log('🔧 FUEL POINTS SHOP:');
      console.log('  - Boostere de Vizibilitate: 4 items');
      console.log('  - Personalizare Profil: 5 items');
      console.log('  - Interacțiuni Sociale: 5 items');
      console.log('  - Acces Rapid: 3 items');
      console.log('\n💎 PREMIUM POINTS SHOP:');
      console.log('  - Premium Match Experience: 5 items');
      console.log('  - Customizare Avansată: 4 items');
      console.log('\n📝 Total: 27 items structured and categorized!');
      db.close();
    })
    .catch((err) => {
      console.error('❌ Error populating structured store items:', err);
      db.close();
    });
}
