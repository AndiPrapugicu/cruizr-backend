const sqlite3 = require('sqlite3').verbose();
const db = new sqlite3.Database('./database.sqlite');

// Clear existing items
console.log('Clearing existing store items...');

db.run('DELETE FROM store_items', (err) => {
  if (err) {
    console.error('Error clearing store items:', err);
    return;
  }

  console.log('âœ… Existing store items cleared');

  // Now populate with new structured items
  populateStructuredItems();
});

function populateStructuredItems() {
  const structuredItems = [
    // ğŸ”§ FUEL POINTS SHOP - Categorii È™i beneficii

    // 1. Boostere de Vizibilitate
    {
      id: 1,
      itemId: 'spotlight-30min',
      name: 'Spotlight (30 min)',
      description: 'Apari primul Ã®n swipe-uri locale timp de 30 minute',
      icon: 'ğŸ”¦',
      price: 25,
      currency: 'fuel',
      category: 'visibility-boost',
      subcategory: 'spotlight',
      duration: 0.5, // 30 minutes
      maxUses: null,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'visibility', multiplier: 10, priority: 'first' },
      metadata: {
        rarity: 'epic',
        shopSection: 'fuel',
        categoryDisplayName: 'Boostere de Vizibilitate',
        benefits: ['Apari primul Ã®n swipe-uri', 'Vizibilitate maximÄƒ localÄƒ'],
      },
    },
    {
      id: 2,
      itemId: 'double-swipe-chance',
      name: 'Double Swipe Chance',
      description: 'Apari de douÄƒ ori unei persoane pentru È™anse mai mari',
      icon: 'ğŸ¯',
      price: 15,
      currency: 'fuel',
      category: 'visibility-boost',
      subcategory: 'double-chance',
      duration: 24,
      maxUses: null,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'matching', multiplier: 2, doubleChance: true },
      metadata: {
        rarity: 'rare',
        shopSection: 'fuel',
        categoryDisplayName: 'Boostere de Vizibilitate',
        benefits: ['Apari de douÄƒ ori', 'È˜anse dublate de match'],
      },
    },
    {
      id: 3,
      itemId: 'highlight-profile-24h',
      name: 'Highlight Profile (24h)',
      description: 'Profilul tÄƒu are un contur colorat special timp de 24 ore',
      icon: 'ğŸŒŸ',
      price: 20,
      currency: 'fuel',
      category: 'visibility-boost',
      subcategory: 'highlight',
      duration: 24,
      maxUses: null,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'visibility', multiplier: 3, highlight: true },
      metadata: {
        rarity: 'rare',
        shopSection: 'fuel',
        categoryDisplayName: 'Boostere de Vizibilitate',
        benefits: ['Contur colorat special', 'Vizibilitate crescutÄƒ'],
      },
    },
    {
      id: 4,
      itemId: 'fuel-streak-bonus',
      name: 'Fuel Streak Bonus',
      description: 'Bonus extra dacÄƒ eÈ™ti activ zilnic - mai multe fuel points',
      icon: 'ğŸ”¥',
      price: 30,
      currency: 'fuel',
      category: 'visibility-boost',
      subcategory: 'streak',
      duration: 168, // 7 days
      maxUses: null,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'fuel', multiplier: 1.5, streakBonus: true },
      metadata: {
        rarity: 'uncommon',
        shopSection: 'fuel',
        categoryDisplayName: 'Boostere de Vizibilitate',
        benefits: ['Bonus fuel zilnic', 'Recompense pentru activitate'],
      },
    },

    // 2. Personalizare profil
    {
      id: 5,
      itemId: 'special-frame',
      name: 'Rama SpecialÄƒ',
      description: 'Rama unicÄƒ pentru profilul tÄƒu - se pÄƒstreazÄƒ permanent',
      icon: 'ğŸ–¼ï¸',
      price: 50,
      currency: 'fuel',
      category: 'profile-customization',
      subcategory: 'frame',
      duration: null,
      maxUses: null,
      isActive: true,
      isPermanent: true,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'profile', customization: 'frame' },
      metadata: {
        rarity: 'rare',
        shopSection: 'fuel',
        categoryDisplayName: 'Personalizare Profil',
        benefits: ['Rama unicÄƒ', 'Personalizare permanentÄƒ'],
      },
    },
    {
      id: 6,
      itemId: 'animated-car-background',
      name: 'Background Animat MaÈ™inÄƒ',
      description: 'Background animat pentru maÈ™ina din profil',
      icon: 'ğŸ¨',
      price: 40,
      currency: 'fuel',
      category: 'profile-customization',
      subcategory: 'background',
      duration: null,
      maxUses: null,
      isActive: true,
      isPermanent: true,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: {
        type: 'profile',
        customization: 'background',
        animation: true,
      },
      metadata: {
        rarity: 'epic',
        shopSection: 'fuel',
        categoryDisplayName: 'Personalizare Profil',
        benefits: ['Background animat', 'Efect vizual impresionant'],
      },
    },
    {
      id: 7,
      itemId: 'daily-driver-badge',
      name: 'Badge "Daily Driver"',
      description:
        'Badge special vizibil Ã®n profil - aratÄƒ cÄƒ eÈ™ti pasionat zilnic',
      icon: 'ğŸ',
      price: 35,
      currency: 'fuel',
      category: 'profile-customization',
      subcategory: 'badge',
      duration: null,
      maxUses: null,
      isActive: true,
      isPermanent: true,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'profile', badge: 'daily-driver' },
      metadata: {
        rarity: 'uncommon',
        shopSection: 'fuel',
        categoryDisplayName: 'Personalizare Profil',
        benefits: ['Badge special', 'AratÄƒ dedicarea ta'],
      },
    },
    {
      id: 8,
      itemId: 'weekend-warrior-badge',
      name: 'Badge "Weekend Warrior"',
      description: 'Badge special pentru pasionaÈ›ii de weekend',
      icon: 'ğŸ†',
      price: 35,
      currency: 'fuel',
      category: 'profile-customization',
      subcategory: 'badge',
      duration: null,
      maxUses: null,
      isActive: true,
      isPermanent: true,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'profile', badge: 'weekend-warrior' },
      metadata: {
        rarity: 'uncommon',
        shopSection: 'fuel',
        categoryDisplayName: 'Personalizare Profil',
        benefits: ['Badge weekend', 'Stil de viaÈ›Äƒ relaxat'],
      },
    },
    {
      id: 9,
      itemId: 'custom-color-theme',
      name: 'Tema de Culori PersonalizatÄƒ',
      description: 'CustomizeazÄƒ culorile interfeÈ›ei aplicaÈ›iei',
      icon: 'ğŸ¨',
      price: 45,
      currency: 'fuel',
      category: 'profile-customization',
      subcategory: 'theme',
      duration: null,
      maxUses: null,
      isActive: true,
      isPermanent: true,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'interface', customization: 'theme' },
      metadata: {
        rarity: 'rare',
        shopSection: 'fuel',
        categoryDisplayName: 'Personalizare Profil',
        benefits: ['Culori personalizate', 'InterfaÈ›Äƒ unicÄƒ'],
      },
    },

    // 3. InteracÈ›iuni sociale
    {
      id: 10,
      itemId: 'car-of-week-vote',
      name: 'Vot "Car of the Week"',
      description: 'ParticipÄƒ la votarea maÈ™inii sÄƒptÄƒmÃ¢nii',
      icon: 'ğŸ—³ï¸',
      price: 10,
      currency: 'fuel',
      category: 'social-interaction',
      subcategory: 'voting',
      duration: 168, // 7 days
      maxUses: null,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'social', feature: 'voting' },
      metadata: {
        rarity: 'common',
        shopSection: 'fuel',
        categoryDisplayName: 'InteracÈ›iuni Sociale',
        benefits: ['ParticipÄƒ la voting', 'Comunitate activÄƒ'],
      },
    },
    {
      id: 11,
      itemId: 'priority-chat-replies',
      name: 'PrioritizeazÄƒ RÄƒspunsurile Ã®n Chat',
      description: 'Mesajele tale apar mai repede Ã®n chat',
      icon: 'âš¡',
      price: 25,
      currency: 'fuel',
      category: 'social-interaction',
      subcategory: 'chat',
      duration: 72, // 3 days
      maxUses: null,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'communication', priority: true },
      metadata: {
        rarity: 'rare',
        shopSection: 'fuel',
        categoryDisplayName: 'InteracÈ›iuni Sociale',
        benefits: ['Mesaje prioritare', 'RÄƒspunsuri mai rapide'],
      },
    },
    {
      id: 12,
      itemId: 'community-meme-vote',
      name: 'VoteazÄƒ Meme-uri Ã®n Comunitate',
      description: 'ParticipÄƒ la votarea celor mai bune meme-uri auto',
      icon: 'ğŸ˜‚',
      price: 15,
      currency: 'fuel',
      category: 'social-interaction',
      subcategory: 'memes',
      duration: 168, // 7 days
      maxUses: null,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'social', feature: 'meme-voting' },
      metadata: {
        rarity: 'common',
        shopSection: 'fuel',
        categoryDisplayName: 'InteracÈ›iuni Sociale',
        benefits: ['VoteazÄƒ meme-uri', 'Divertisment comunitar'],
      },
    },
    {
      id: 13,
      itemId: 'exclusive-polls-access',
      name: 'Acces la Sondaje Exclusive',
      description:
        'ParticipÄƒ la sondaje speciale despre maÈ™ini È™i trending topics',
      icon: 'ğŸ“Š',
      price: 20,
      currency: 'fuel',
      category: 'social-interaction',
      subcategory: 'polls',
      duration: 168, // 7 days
      maxUses: null,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'social', feature: 'exclusive-polls' },
      metadata: {
        rarity: 'uncommon',
        shopSection: 'fuel',
        categoryDisplayName: 'InteracÈ›iuni Sociale',
        benefits: ['Sondaje exclusive', 'Opinii valoroase'],
      },
    },
    {
      id: 14,
      itemId: 'exclusive-chat-emojis',
      name: 'Emojis Exclusive Ã®n Chat',
      description: 'FoloseÈ™te emoji-uri speciale doar pentru membrii activi',
      icon: 'ğŸš—',
      price: 30,
      currency: 'fuel',
      category: 'social-interaction',
      subcategory: 'emojis',
      duration: null,
      maxUses: null,
      isActive: true,
      isPermanent: true,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'communication', feature: 'exclusive-emojis' },
      metadata: {
        rarity: 'rare',
        shopSection: 'fuel',
        categoryDisplayName: 'InteracÈ›iuni Sociale',
        benefits: ['Emoji-uri exclusive', 'Expresivitate sporitÄƒ'],
      },
    },

    // 4. Acces rapid
    {
      id: 15,
      itemId: 'reverse-swipe',
      name: 'Unlock Swipe Rewind',
      description: 'Dai Ã®napoi dacÄƒ ai dat swipe greÈ™it - o utilizare',
      icon: 'â†©ï¸',
      price: 20,
      currency: 'fuel',
      category: 'quick-access',
      subcategory: 'rewind',
      duration: null,
      maxUses: 1,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'matching', feature: 'rewind' },
      metadata: {
        rarity: 'common',
        shopSection: 'fuel',
        categoryDisplayName: 'Acces Rapid',
        benefits: ['CorecteazÄƒ swipe-uri', 'È˜anse Ã®n plus'],
      },
    },
    {
      id: 16,
      itemId: 'daily-who-swiped',
      name: 'Vezi cine È›i-a dat swipe (1 datÄƒ/zi)',
      description: 'DescoperÄƒ cine te-a swipe-uit - o utilizare pe zi',
      icon: 'ğŸ‘ï¸',
      price: 25,
      currency: 'fuel',
      category: 'quick-access',
      subcategory: 'reveal',
      duration: 24,
      maxUses: 1,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'discovery', feature: 'daily-reveal' },
      metadata: {
        rarity: 'uncommon',
        shopSection: 'fuel',
        categoryDisplayName: 'Acces Rapid',
        benefits: ['Vezi cine te-a swipe-uit', 'InformaÈ›ii valoroase'],
      },
    },
    {
      id: 17,
      itemId: 'refresh-swipe-zone',
      name: 'Refresh Zona de Swipe',
      description: 'ReÃ®ncarcÄƒ locaÈ›iile È™i gÄƒseÈ™te persoane noi',
      icon: 'ğŸ”„',
      price: 15,
      currency: 'fuel',
      category: 'quick-access',
      subcategory: 'refresh',
      duration: null,
      maxUses: 1,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'matching', feature: 'refresh' },
      metadata: {
        rarity: 'common',
        shopSection: 'fuel',
        categoryDisplayName: 'Acces Rapid',
        benefits: ['Persoane noi', 'LocaÈ›ii reÃ®ncÄƒrcate'],
      },
    },

    // ğŸ’ PREMIUM POINTS SHOP - Beneficii exclusive

    // 1. Premium Match Experience
    {
      id: 18,
      itemId: 'unlimited-who-liked',
      name: 'Vezi toÈ›i cei care te-au dat swipe (nelimitat)',
      description: 'Acces nelimitat la cine te-a swipe-uit - fÄƒrÄƒ restricÈ›ii',
      icon: 'ğŸ‘€',
      price: 50,
      currency: 'premium',
      category: 'premium-match',
      subcategory: 'unlimited-reveal',
      duration: null,
      maxUses: null,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'discovery', feature: 'unlimited-reveal' },
      metadata: {
        rarity: 'legendary',
        shopSection: 'premium',
        categoryDisplayName: 'Premium Match Experience',
        benefits: ['Acces nelimitat', 'Toate swipe-urile vizibile'],
      },
    },
    {
      id: 19,
      itemId: 'absolute-priority',
      name: 'Prioritizare AbsolutÄƒ Ã®n Swipe List',
      description: 'Apari primul Ã®n lista de swipe-uri la toatÄƒ lumea',
      icon: 'ğŸ‘‘',
      price: 75,
      currency: 'premium',
      category: 'premium-match',
      subcategory: 'absolute-priority',
      duration: 168, // 7 days
      maxUses: null,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'visibility', priority: 'absolute', multiplier: 20 },
      metadata: {
        rarity: 'legendary',
        shopSection: 'premium',
        categoryDisplayName: 'Premium Match Experience',
        benefits: ['Prioritate absolutÄƒ', 'Vizibilitate maximÄƒ'],
      },
    },
    {
      id: 20,
      itemId: 'chat-without-match',
      name: 'Chat fÄƒrÄƒ Match',
      description: 'PoÈ›i trimite 1 mesaj special fÄƒrÄƒ match - doar premium',
      icon: 'ğŸ’¬',
      price: 30,
      currency: 'premium',
      category: 'premium-match',
      subcategory: 'no-match-chat',
      duration: null,
      maxUses: 1,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'communication', feature: 'no-match-message' },
      metadata: {
        rarity: 'epic',
        shopSection: 'premium',
        categoryDisplayName: 'Premium Match Experience',
        benefits: ['Mesaj fÄƒrÄƒ match', 'È˜anse Ã®n plus'],
      },
    },
    {
      id: 21,
      itemId: 'match-radar',
      name: 'Match Radar',
      description: 'ArÄƒtare potenÈ›iali compatibili Ã®n jurul tÄƒu - live updates',
      icon: 'ğŸ“¡',
      price: 60,
      currency: 'premium',
      category: 'premium-match',
      subcategory: 'radar',
      duration: 168, // 7 days
      maxUses: null,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'discovery', feature: 'match-radar' },
      metadata: {
        rarity: 'legendary',
        shopSection: 'premium',
        categoryDisplayName: 'Premium Match Experience',
        benefits: ['Live radar', 'Compatibili Ã®n apropiere'],
      },
    },
    {
      id: 22,
      itemId: 'super-boosted-like',
      name: 'Like Super Boosted',
      description: 'Apari Ã®n topul feed-ului lor cÃ¢nd dai like',
      icon: 'â­',
      price: 25,
      currency: 'premium',
      category: 'premium-match',
      subcategory: 'super-like',
      duration: null,
      maxUses: 5,
      isActive: true,
      isPermanent: false,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'matching', feature: 'super-boosted-like' },
      metadata: {
        rarity: 'epic',
        shopSection: 'premium',
        categoryDisplayName: 'Premium Match Experience',
        benefits: ['Like super boosted', 'AtenÈ›ie maximÄƒ'],
      },
    },

    // 2. Customizare avansatÄƒ
    {
      id: 23,
      itemId: 'profile-3d-view',
      name: 'Profil 3D View cu maÈ™ina ta',
      description: 'Vizualizare 3D interactivÄƒ a maÈ™inii tale Ã®n profil',
      icon: 'ğŸ®',
      price: 80,
      currency: 'premium',
      category: 'advanced-customization',
      subcategory: '3d-view',
      duration: null,
      maxUses: null,
      isActive: true,
      isPermanent: true,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'profile', feature: '3d-view' },
      metadata: {
        rarity: 'legendary',
        shopSection: 'premium',
        categoryDisplayName: 'Customizare AvansatÄƒ',
        benefits: ['Vizualizare 3D', 'ExperienÈ›Äƒ interactivÄƒ'],
      },
    },
    {
      id: 24,
      itemId: 'iconic-car-theme-gtr',
      name: 'Tema Premium - GTR',
      description: 'Tema inspiratÄƒ din maÈ™ini iconice - Nissan GTR',
      icon: 'ğŸï¸',
      price: 45,
      currency: 'premium',
      category: 'advanced-customization',
      subcategory: 'iconic-theme',
      duration: null,
      maxUses: null,
      isActive: true,
      isPermanent: true,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'interface', theme: 'gtr' },
      metadata: {
        rarity: 'epic',
        shopSection: 'premium',
        categoryDisplayName: 'Customizare AvansatÄƒ',
        benefits: ['Tema GTR', 'Design iconic'],
      },
    },
    {
      id: 25,
      itemId: 'iconic-car-theme-m3',
      name: 'Tema Premium - BMW M3',
      description: 'Tema inspiratÄƒ din maÈ™ini iconice - BMW M3',
      icon: 'ğŸš™',
      price: 45,
      currency: 'premium',
      category: 'advanced-customization',
      subcategory: 'iconic-theme',
      duration: null,
      maxUses: null,
      isActive: true,
      isPermanent: true,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'interface', theme: 'm3' },
      metadata: {
        rarity: 'epic',
        shopSection: 'premium',
        categoryDisplayName: 'Customizare AvansatÄƒ',
        benefits: ['Tema M3', 'EleganÈ›Äƒ sportivy'],
      },
    },
    {
      id: 26,
      itemId: 'iconic-car-theme-wrx',
      name: 'Tema Premium - Subaru WRX',
      description: 'Tema inspiratÄƒ din maÈ™ini iconice - Subaru WRX',
      icon: 'ğŸš—',
      price: 45,
      currency: 'premium',
      category: 'advanced-customization',
      subcategory: 'iconic-theme',
      duration: null,
      maxUses: null,
      isActive: true,
      isPermanent: true,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'interface', theme: 'wrx' },
      metadata: {
        rarity: 'epic',
        shopSection: 'premium',
        categoryDisplayName: 'Customizare AvansatÄƒ',
        benefits: ['Tema WRX', 'Spirit rally'],
      },
    },
    {
      id: 27,
      itemId: 'premium-racer-badge',
      name: 'Badge "Premium Racer" Animat',
      description: 'Badge premium animat exclusiv pentru membri premium',
      icon: 'ğŸ',
      price: 35,
      currency: 'premium',
      category: 'advanced-customization',
      subcategory: 'premium-badge',
      duration: null,
      maxUses: null,
      isActive: true,
      isPermanent: true,
      isLimited: false,
      limitedQuantity: null,
      requirements: null,
      effects: { type: 'profile', badge: 'premium-racer', animated: true },
      metadata: {
        rarity: 'legendary',
        shopSection: 'premium',
        categoryDisplayName: 'Customizare AvansatÄƒ',
        benefits: ['Badge animat', 'Status premium'],
      },
    },
  ];

  console.log('Populating structured store items...');

  const insertPromises = structuredItems.map((item) => {
    return new Promise((resolve, reject) => {
      const sql = `
        INSERT INTO store_items (
          id, itemId, name, description, icon, price, currency, category, 
          subcategory, duration, maxUses, isActive, isPermanent, isLimited, 
          limitedQuantity, requirements, effects, metadata, createdAt, updatedAt
        ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
      `;

      const now = new Date().toISOString();

      db.run(
        sql,
        [
          item.id,
          item.itemId,
          item.name,
          item.description,
          item.icon,
          item.price,
          item.currency,
          item.category,
          item.subcategory,
          item.duration,
          item.maxUses,
          item.isActive,
          item.isPermanent,
          item.isLimited,
          item.limitedQuantity,
          JSON.stringify(item.requirements),
          JSON.stringify(item.effects),
          JSON.stringify(item.metadata),
          now,
          now,
        ],
        function (err) {
          if (err) {
            reject(err);
          } else {
            console.log(
              `âœ… Added: ${item.name} (${item.currency.toUpperCase()}: ${item.price})`,
            );
            resolve(this.lastID);
          }
        },
      );
    });
  });

  Promise.all(insertPromises)
    .then(() => {
      console.log(
        '\nğŸ‰ All structured store items have been populated successfully!',
      );
      console.log('\nğŸ“Š Summary:');
      console.log('ğŸ”§ FUEL POINTS SHOP:');
      console.log('  - Boostere de Vizibilitate: 4 items');
      console.log('  - Personalizare Profil: 5 items');
      console.log('  - InteracÈ›iuni Sociale: 5 items');
      console.log('  - Acces Rapid: 3 items');
      console.log('\nğŸ’ PREMIUM POINTS SHOP:');
      console.log('  - Premium Match Experience: 5 items');
      console.log('  - Customizare AvansatÄƒ: 4 items');
      console.log('\nğŸ“ Total: 27 items structured and categorized!');
      db.close();
    })
    .catch((err) => {
      console.error('âŒ Error populating structured store items:', err);
      db.close();
    });
}
